function disqus_config(){this.callbacks.onNewComment=[function(){om.trackCommentAdd()}]}define("lib/cookie",[],function(){var cookie=function(name,value,options){if("undefined"==typeof value){var cookieValue=null;if(document.cookie&&""!=document.cookie)for(var cookies=document.cookie.split(";"),i=0;i<cookies.length;i++){var cookie=cookies[i].trim();if(cookie.substring(0,name.length+1)==name+"="){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}return cookieValue}options=options||{};if(null===value){value="";options.expires=-1}var expires="";if(options.expires&&("number"==typeof options.expires||options.expires.toUTCString))if(options.expires<0)expires="; expires=Thu, 01 Jan 1970 00:00:00 GMT";else{var date;if("number"==typeof options.expires){date=new Date;date.setTime(date.getTime()+1e3*60*60*24*options.expires)}else date=options.expires;expires="; expires="+date.toUTCString()}var path=options.path?"; path="+options.path:"",domain=options.domain?"; domain="+options.domain:"",secure=options.secure?"; secure":"";document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join("")};return cookie});define("lib/findingMethod",["jquery","lib/cookie"],function($,cookie){var setFindingMethod=function(cookieValue){cookie("mlFindingMethod",cookieValue,{expires:365,path:"/",domain:"."+document.domain})};$("input.search-btn").on("mousedown",function(){setFindingMethod("Internal:Navigation:Search Icon")});$("#search-tools div p a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Search Letter")});$("nav.nav-main ul li a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Main Menu")});$("ul.tabs li a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Tabbed Menu")});$(".artist-header a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artist Menu")});$("#misc-header a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Misc Menu")});$("#page-footer a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Footer Song List")});$("a.vid").on("mousedown",function(){setFindingMethod("Internal:Navigation:Video Icon")});$(".grid_8 .content ul li a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Top Lyrics List")});$(".content-header .grid_12 p a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Top Lyrics List")});$(".latest-songs ul li a.title").on("mousedown",function(){setFindingMethod("Internal:Navigation:Home Latest Songs")});$(".latest-songs header a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Home Latest Header")});$("table.songs-table tbody tr td a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artists")});$(".top-artists ul li a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artists")});$("p.artist-letters a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artists Letter")});$("ul.albums a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artists Letter")});$(".news-leader a").on("mousedown",function(){setFindingMethod("Internal:Navigation:News Leader")});$("p.pagination a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Pagination")});$(".lyrics-top a.badge").on("mousedown",function(){setFindingMethod("Internal:Navigation:Lyric Badge")});$("#news-features a").on("mousedown",function(){setFindingMethod("Internal:Navigation:News Features Widget")});$("ul.similar-artists a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Similar Artist Widget")});$("#artistGallery a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artist Gallery Widget")});$("#music-news a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Music News Widget")});$("#album-songs a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Album Songs Widget")});$("#photoGallery a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Photo Gallery Widget")});$("#videoGallery a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Video Gallery Widget")});$(".artist-top-songs a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artist Top Songs Widget")});$(".special-top5 a.song").on("mousedown",function(){setFindingMethod("Internal:Click From Content")});$(".top-songs a").on("mousedown",function(){setFindingMethod("Internal:Click From Content")});$("article.story a").on("mousedown",function(){setFindingMethod("Internal:Click From Content")});$("#slider-home li a").on("mousedown",function(){setFindingMethod("Internal:Click From Content")});var iframe=$("#footer-iframe");iframe.ready(function(){iframe.contents().find("p.links a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Footer Credits")})});return setFindingMethod});define("lib/adConfig",["jquery","lib/cookie"],function($,cookie){var adConfig=cookie("ml_ad_config");if(null!=adConfig){var div=$("<div>").css({"z-index":Math.pow(2,64),position:"fixed",bottom:10,right:10,padding:10,cursor:"pointer","background-color":"#ddd","border-bottom":"1px solid #bbb","border-right":"1px solid #bbb","border-top":"1px solid #eee","border-left":"1px solid #eee"}).text("Clear Custom Ad Config");$("body").append(div);div.on("click",function(){cookie("ml_ad_config","",{expires:-1});window.location=window.location.protocol+"//"+window.location.hostname+"/"+window.location.pathname})}});define("vendor/domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t+=1)e[t](s)}function a(){var e=o;if(i&&e.length){o=[];u(e)}}function f(){if(!i){i=!0;n&&clearInterval(n);a()}}function c(e){i?e(s):o.push(e);return c}var e,t,n,r="undefined"!=typeof window&&window.document,i=!r,s=r?document:null,o=[];if(r){if(document.addEventListener){document.addEventListener("DOMContentLoaded",f,!1);window.addEventListener("load",f,!1)}else if(window.attachEvent){window.attachEvent("onload",f);t=document.createElement("div");try{e=null===window.frameElement}catch(l){}t.doScroll&&e&&window.external&&(n=setInterval(function(){try{t.doScroll();f()}catch(e){}},30))}"complete"===document.readyState&&f()}c.version="2.0.1";c.load=function(e,t,n,r){r.isBuild?n(null):c(n)};return c});define("lib/common",["jquery","lib/cookie","angular","lib/findingMethod","lib/adConfig","vendor/domReady!"],function($,cookie,angular){var themeCookie=cookie("X-Theme-force"),viewedCookie=cookie("ML-mobile-view"),$mobileView=$(".mobile-view"),$mobileYes=$mobileView.find(".yes"),$mobileNo=$mobileView.find(".no");"desktop"===themeCookie&&"false"===viewedCookie&&$mobileView.slideDown();$mobileYes.on("click",function(){cookie("X-Theme-force",null,{path:"/",domain:"."+document.domain});location.reload(!0)});$mobileNo.on("click",function(){cookie("ML-mobile-view","true",{path:"/",domain:"."+document.domain});$mobileView.slideUp()});var ngApp=angular.module("ngApp",[]);ngApp.controller("headerCtrl",["$rootScope","$scope",function($root){$root.header={search:{keyword:null,state:"open",open:function(){$root.fpo.open("header-search")},close:function(){$root.fpo.close()},submit:function(){this.keyword&&""!=this.keyword&&$("#fpo form.search").submit()}}}}]);ngApp.controller("fpOverlayCtrl",["$rootScope",function($root){$root.fpo={visible:!1,templateUrl:"",open:function(filename){$root.fpo.visible=!0;this.templateUrl="template/desktop/"+filename+".php"},close:function(){this.visible=!1;this.templateUrl=""}}}]);ngApp.directive("stopEvent",function(){return{restrict:"A",link:function(scope,element,attr){element.bind(attr.stopEvent,function(e){e.stopPropagation()})}}});ngApp.filter("unsafe",function($sce){return function(val){return $sce.trustAsHtml(val)}});return ngApp});define("lib/overlay",["jquery"],function($){var Overlay={options:{id:"overlay",myClass:"overlay",selector:"#overlay",onclick:null}};Overlay.init=function(settings){var options=$.extend({},this.options,settings),element=$(this.options.selector);if(0===element.length){element=$("<div></div>");element.appendTo("body")}element[0].id=this.options.id;element.addClass(this.options.myClass);element.on("click.overlay",function(e){if($(e.target).is(element)){!function(){Overlay.hideOverlay()}();"function"==typeof options.onclick&&options.onclick.apply(this,arguments)}});this.element=element;return this};Overlay.showOverlay=function(){return this.element.show()};Overlay.hideOverlay=function(){return this.element.hide()};Overlay.getElement=function(){return this.element};return Overlay});define("lib/lightbox",["jquery","lib/overlay"],function($,overlay){var LightBox={options:{selector:"#lightbox",onclose:"",detach:!0}};LightBox.init=function(settings){var options=$.extend({},this.options,settings),element=$(options.selector),that=this;overlay.init({onclick:function(){that.hideLightBox()}});element.on("click",".close",function(){that.hideLightBox()});this.element=element;this.onclose=options.onclose;options.detach&&$(element).detach().appendTo(overlay.getElement());return this};LightBox.showLightBox=function(){overlay.showOverlay();this.element.show()};LightBox.hideLightBox=function(){if(this.element){this.element.hide();overlay.hideOverlay()}$.isFunction(this.onclose)&&this.onclose()};return LightBox});define("lib/socialbar",["jquery"],function($){var SocialBar={$socialBars:null,init:function(){this.$socialBars=$(".social-bar");this.$socialBars.length&&this.$socialBars.each(function(){var $bar=$(this),$tooltip=$bar.find(".social-tooltip");$tooltip.length&&setTimeout(function(){$tooltip.fadeOut(500)},1e3);$bar.find("a.social-link").on("click",function(){var href=$(this).attr("popup-href"),height=$(this).attr("popup-height"),width=600,left=screen.width/2-300,top=screen.height/2-height/2,options="menubar=no,toolbar=no,resizable=yes,scrollbars=yes,left="+left+","+"top="+top+","+"scrollbars=yes,"+"height="+height+",width="+width;window.open(href,"",options)})})}};return SocialBar});define("app/../../../application/widgets/Poll/js/../../../../js/lib/cookie",[],function(){var cookie=function(name,value,options){if("undefined"==typeof value){var cookieValue=null;if(document.cookie&&""!=document.cookie)for(var cookies=document.cookie.split(";"),i=0;i<cookies.length;i++){var cookie=cookies[i].trim();if(cookie.substring(0,name.length+1)==name+"="){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}return cookieValue}options=options||{};if(null===value){value="";options.expires=-1}var expires="";if(options.expires&&("number"==typeof options.expires||options.expires.toUTCString))if(options.expires<0)expires="; expires=Thu, 01 Jan 1970 00:00:00 GMT";else{var date;if("number"==typeof options.expires){date=new Date;date.setTime(date.getTime()+1e3*60*60*24*options.expires)}else date=options.expires;expires="; expires="+date.toUTCString()}var path=options.path?"; path="+options.path:"",domain=options.domain?"; domain="+options.domain:"",secure=options.secure?"; secure":"";document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join("")};return cookie});define("app/../../../application/widgets/Poll/js/module.js",["jquery","../../../../js/lib/cookie"],function($,cookie){pollCtrlInit=function(ngApp){ngApp.controller("pollCtrl",["$scope",function($scope){var $spinner=$("#pollspinner");$scope.poll={pollId:null,state:null,apiUrl:null,sendUrl:null,question:null,options:null,pollCookie:[],init:function(url){cookie("mlPoll")&&($scope.poll.pollCookie=JSON.parse(cookie("mlPoll")));$scope.poll.apiUrl=url;$scope.poll.state="question";var Qdata={pollIds:$scope.poll.pollCookie};$scope.poll.dispatch($scope.poll.apiUrl+"/init",Qdata)},dispatch:function(sendUrl,Qdata){Qdata.format="jsonp";Qdata.pollIds&&(Qdata.pollIds=JSON.stringify(Qdata.pollIds));$spinner.show();$.ajax({cache:!1,async:!0,crossDomain:!0,data:Qdata,url:sendUrl,dataType:"jsonp",type:"POST"}).fail(function(){$scope.poll.showMessage("Thank you for voting on all the polls.")}).done(function(data){$scope.poll.pollId=data.nextPoll.pollid;$scope.poll.question=data.nextPoll.question;$scope.poll.options=data.nextPoll.options;if(data.showResults){$scope.poll.pollCookie.push($scope.poll.pollId);cookie("mlPoll",JSON.stringify($scope.poll.pollCookie),{expires:365,path:"/"});$scope.poll.state="result";$scope.poll.loaded=!0;$spinner.hide();$scope.$apply()}else if($scope.poll.pollId){$scope.poll.state="question";$scope.poll.loaded=!0;$spinner.hide();$scope.$apply()}else $scope.poll.showMessage("Thank you for voting on all the polls.")})},showMessage:function(msg){$spinner.hide();$scope.poll.message=msg;$scope.poll.loaded=!1;$scope.$apply()},submit:function(){var poll_body=$("#poll_body"),answerId=poll_body.find("input:checked").val();if(answerId){var Qdata={pollId:$scope.poll.pollId,answerId:answerId},sendUrl=$scope.poll.apiUrl+"/results";$scope.poll.dispatch(sendUrl,Qdata)}else $("#poll_button").text("Pick One")},nextPoll:function(){var Qdata={pollIds:$scope.poll.pollCookie},sendUrl=$scope.poll.apiUrl+"/next";$scope.poll.dispatch(sendUrl,Qdata)}}}])};return pollCtrlInit});define("app/../../../application/widgets/LyricHeaderVideo/js/../../../../js/lib/overlay",["jquery"],function($){var Overlay={options:{id:"overlay",myClass:"overlay",selector:"#overlay",onclick:null}};Overlay.init=function(settings){var options=$.extend({},this.options,settings),element=$(this.options.selector);if(0===element.length){element=$("<div></div>");element.appendTo("body")}element[0].id=this.options.id;element.addClass(this.options.myClass);element.on("click.overlay",function(e){if($(e.target).is(element)){!function(){Overlay.hideOverlay()}();"function"==typeof options.onclick&&options.onclick.apply(this,arguments)}});this.element=element;return this};Overlay.showOverlay=function(){return this.element.show()};Overlay.hideOverlay=function(){return this.element.hide()};Overlay.getElement=function(){return this.element};return Overlay});define("app/../../../application/widgets/LyricHeaderVideo/js/../../../../js/lib/noscrollVertical",[],function(){var noscrollVertical=function(el,boundedElement,parentTopOffset,parentBottomOffset){var counter=0;if(3==arguments.length){if("object"==typeof arguments[0]&&"object"==typeof arguments[1]&&"number"==typeof parseInt(arguments[2],10))var parentBottomOffset=0;else if("object"==typeof arguments[0]&&"number"==typeof arguments[1]&&"number"==typeof arguments[2])var boundedElement=document.body}else if(2==arguments.length){if("object"==typeof arguments[0]&&"object"==typeof arguments[1])var parentTopOffset=0,parentBottomOffset=0;else if("object"==typeof arguments[0]&&"number"==typeof arguments[1])var boundedElement=document.body,parentBottomOffset=0}else if(1==arguments.length&&"object"==typeof arguments[0])var boundedElement=document.body,parentTopOffset=0,parentBottomOffset=0;0===parentBottomOffset&&(parentBottomOffset=boundedElement.offsetHeight);el.style.position="relative";var internalHeight=$(boundedElement).offset().top+parentTopOffset,eventListener=function(){if(0!=counter){var y=window.pageYOffset;y>internalHeight&&y+el.offsetHeight<parentBottomOffset?el.style.top=y-internalHeight+"px":internalHeight>=y?el.style.top="0px":el.offsetTop+el.offsetHeight>=parentBottomOffset&&(el.style.top=boundedElement.offsetTop+boundedElement.offsetHeight-el.offsetHeight+"px")}else{el.style.top="0px";counter++}};window.addEventListener?window.addEventListener("scroll",eventListener,!0):window.attachEvent&&window.attachEvent("scroll",eventListener)};return noscrollVertical});define("app/../../../application/widgets/LyricHeaderVideo/js/../../../../js/lib/findingMethod",["jquery","lib/cookie"],function($,cookie){var setFindingMethod=function(cookieValue){cookie("mlFindingMethod",cookieValue,{expires:365,path:"/",domain:"."+document.domain})};$("input.search-btn").on("mousedown",function(){setFindingMethod("Internal:Navigation:Search Icon")});$("#search-tools div p a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Search Letter")});$("nav.nav-main ul li a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Main Menu")});$("ul.tabs li a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Tabbed Menu")});$(".artist-header a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artist Menu")});$("#misc-header a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Misc Menu")});$("#page-footer a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Footer Song List")});$("a.vid").on("mousedown",function(){setFindingMethod("Internal:Navigation:Video Icon")});$(".grid_8 .content ul li a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Top Lyrics List")});$(".content-header .grid_12 p a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Top Lyrics List")});$(".latest-songs ul li a.title").on("mousedown",function(){setFindingMethod("Internal:Navigation:Home Latest Songs")});$(".latest-songs header a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Home Latest Header")});$("table.songs-table tbody tr td a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artists")});$(".top-artists ul li a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artists")});$("p.artist-letters a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artists Letter")});$("ul.albums a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artists Letter")});$(".news-leader a").on("mousedown",function(){setFindingMethod("Internal:Navigation:News Leader")});$("p.pagination a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Pagination")});$(".lyrics-top a.badge").on("mousedown",function(){setFindingMethod("Internal:Navigation:Lyric Badge")});$("#news-features a").on("mousedown",function(){setFindingMethod("Internal:Navigation:News Features Widget")});$("ul.similar-artists a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Similar Artist Widget")});$("#artistGallery a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artist Gallery Widget")});$("#music-news a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Music News Widget")});$("#album-songs a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Album Songs Widget")});$("#photoGallery a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Photo Gallery Widget")});$("#videoGallery a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Video Gallery Widget")});$(".artist-top-songs a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Artist Top Songs Widget")});$(".special-top5 a.song").on("mousedown",function(){setFindingMethod("Internal:Click From Content")});$(".top-songs a").on("mousedown",function(){setFindingMethod("Internal:Click From Content")});$("article.story a").on("mousedown",function(){setFindingMethod("Internal:Click From Content")});$("#slider-home li a").on("mousedown",function(){setFindingMethod("Internal:Click From Content")});var iframe=$("#footer-iframe");iframe.ready(function(){iframe.contents().find("p.links a").on("mousedown",function(){setFindingMethod("Internal:Navigation:Footer Credits")})});return setFindingMethod});define("app/../../../application/widgets/LyricHeaderVideo/js/module.js",["jquery","../../../../js/lib/overlay","../../../../js/lib/noscrollVertical","../../../../js/lib/findingMethod"],function($,$overlay,noscrollVertical,findingMethod){function LyricHeaderVideo(element,options){this.element=element;this.options=$.extend({},defaults,options);this._defaults=defaults;this._name=pluginName;this.init()}window.videoPlayer={player:!1,youtube:!1,ready:!1};var pluginName="lyricHeaderVideo",defaults={},$lyricsVideo=$("#lyrics-video-over"),$headerVideo=$("#headerVideo"),$lyricsvidEmbed=$lyricsVideo.find(".embed"),$lyricHeaderVideo=$("#"+pluginName),$method="Internal:";$method+="1"===$lyricHeaderVideo.data("driver")?"Click From Content:Lyric Header Video Driver":"Navigation:Lyric Header Video";$("#lyrics-video-scroll a").on("mousedown",function(){findingMethod($method)});LyricHeaderVideo.prototype={isYoutube:!1,isReady:!1,init:function(){if(!($lyricsVideo.length<1)){$overlay.init({onclick:this.closeLyrVid});$lyricsVideo.detach().appendTo("#lyrics-main .right-panel");if($headerVideo.length&&"youtube"==$headerVideo.data("provider")){this.isYoutube=!0;window.onYouTubeIframeAPIReady=this.loadYoutubeVideo;require(["youtube"])}var videoScroll=$("#lyrics-video-scroll")[0],lyricMain=$(".lyrics"),divheaderOffset=$(".lyrics-top").outerHeight(!0);videoScroll&&noscrollVertical(videoScroll,lyricMain[0],divheaderOffset-60,lyricMain.offset().top+lyricMain.outerHeight(!0));$(this.element).on("click",this.openLyrVid);$lyricsVideo.on("click",".close",this.closeLyrVid);"#/startvideo"===window.location.hash&&this.openLyrVid()}},openLyrVid:function(){$lyricsvidEmbed.remove();$lyricsVideo.find(".lyrics-video-scroll > header").after($lyricsvidEmbed);window.videoPlayer.ready&&window.videoPlayer.youtube&&window.videoPlayer.player&&window.videoPlayer.player.playVideo();$("body").addClass("lyrics-video-view");$(".skinAd .main").css("position","static");$("#lyrics-video-over").fadeIn("fast");$overlay.showOverlay();window.location.hash="#/startvideo"},closeLyrVid:function(){if(!($lyricsVideo.length<1)){window.videoPlayer.ready&&window.videoPlayer.youtube&&window.videoPlayer.player&&window.videoPlayer.player.stopVideo();$(".skinAd .main").css("position","relative");$("#lyrics-video-over").fadeOut("fast");$("body").removeClass("lyrics-video-view");$overlay.hideOverlay();window.location.hash="";$lyricsvidEmbed.remove();$lyricsVideo.find(".lyrics-video-scroll > header").after($lyricsvidEmbed)}},loadYoutubeVideo:function(){var headerVideo=$("#headerVideo");console.log(this,YT,"video api loaded");player=new YT.Player("headerVideo",{height:"260",width:"460",videoId:headerVideo.data("providerid"),playerVars:{rel:0},events:{onReady:function(){videoPlayer.youtube=!0;videoPlayer.ready=!0;videoPlayer.player=player;"#/startvideo"===window.location.hash&&player.playVideo()}}})}};$.fn[pluginName]=function(options){return this.each(function(){$.data(this,"plugin_"+pluginName)||$.data(this,"plugin_"+pluginName,new LyricHeaderVideo(this,options))})}});define("lib/fb",["facebook"],function(){FB.init({appId:"108972655795148",channelUrl:"//"+location.hostname+"/external/facebookchannel.html"})});define("lib/util",[],function(){"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s*(\S*(\s+\S+)*)\s$/,"$1")});"function"!=typeof String.prototype.capitalize&&(String.prototype.capitalize=function(){return this.replace(/(^|\s)([a-z])/g,function(m,p1,p2){return p1+p2.toUpperCase()})});"function"!=typeof Array.prototype.indexOf&&(Array.prototype.indexOf=function(obj){for(var i=0;i<this.length;i++)if(this[i]==obj)return i;return-1})});define("lib/lyricshare",["jquery","lib/fb","lib/util"],function($){function LyricShare(element,options){this.element=element;this.options=$.extend({},defaults,options);this._defaults=defaults;this._name=pluginName;this.init()}var pluginName="lyricShare",defaults={minHeight:"48",maxHeight:"115",selector:"p",fbLines:5,twChars:105,twNewLine:" / ",imageUrl:!1};LyricShare.prototype={init:function(){var lyricShare=this,shareLyrics=$("#share-lyrics"),verses=$(this.element).find(this.options.selector);lyricShare.shareLyrics=shareLyrics;verses.on("mouseover."+this._name,function(){var that=$(this),pHeight=that.height();that.height()>=lyricShare.options.minHeight&&shareLyrics.css({height:pHeight+"px",top:that.offset().top-that.parent().offset().top}).data("context",$(that.context))});shareLyrics.find("li").on("click",function(){var element=$(this);if(element.hasClass("fb")){lyricShare.facebookShare(this,lyricShare.options);om.trackSocialClick({id:2});return!0}if(element.hasClass("tw")){lyricShare.twitterShare(this,lyricShare.options);om.trackSocialClick({id:8});return!0}if(element.hasClass("gp")){lyricShare.googleplusShare(this,lyricShare.options);return!0}return!1}).show();$.each(verses,function(){if($(this).height()>=lyricShare.options.minHeight){$(this).trigger("mouseover."+lyricShare._name);shareLyrics.show();return!1}})},facebookShare:function(el,options){var context=("http://"+location.host,this.shareLyrics.data("context").text().trim()),lines=context.replace(/\[.*\]/,"").replace(/\n{2,}/,"\n").split("\n");$(lines).children().remove();lines=lines.slice(0,options.fbLines);for(var i=0;i<lines.length;i++)lines[i]=lines[i].trim();lines=lines.join("<center></center>");var dataObject={method:"feed",name:$("title").text(),link:location.href,caption:"from MetroLyrics.com",description:lines};!1!==options.imageUrl&&(dataObject.picture=options.imageUrl);FB.ui(dataObject)},twitterShare:function(el,options){for(var windowOptions="scrollbars=yes,resizable=yes,toolbar=no,location=yes",width=550,height=280,context=this.shareLyrics.data("context").text().split("\n"),windowLoc=this.calcWindowLocation(width,height),i=0;i<context.length;i++)context[i]=context[i].trim();context=context.join(options.twNewLine);if(context.length>this.options.twChars){context=context.substring(0,this.options.twChars+1);context=context.substring(0,Math.min(context.length,context.lastIndexOf(options.twNewLine)))}context+=" @metrolyrics ";window.open("https://twitter.com/intent/tweet?text="+context+"&tw_p=tweetbutton&url="+encodeURI(location.href),"intent",windowOptions+",width="+width+",height="+height+",left="+windowLoc.left+",top="+windowLoc.top)},googleplusShare:function(){var windowLoc=this.calcWindowLocation(600,600);window.open("https://plus.google.com/share?url="+encodeURI(location.href),"Share on Google+","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600,left="+windowLoc.left+",top="+windowLoc.top)},calcWindowLocation:function(width,height){var left,top,winHeight=$(window).height(),winWidth=$(window).width();left=Math.round(winWidth/2-width/2);top=0;winHeight>height&&(top=Math.round(winHeight/2-height/2));return{left:left,top:top}},getSelectionText:function(){var t="";window.getSelection?t=window.getSelection():document.getSelection?t=document.getSelection():document.selection&&(t=document.selection.createRange().text);return t}};$.fn[pluginName]=function(options){return this.each(function(){$.data(this,"plugin_"+pluginName)||$.data(this,"plugin_"+pluginName,new LyricShare(this,options))})}});define("app/../../../application/widgets/LyricBodyHeader/js/module.js",["jquery"],function($){return $(function(){$("#album-name-link").on("click",function(){var albumSongs=$("#album-songs");albumSongs.is(":visible")?albumSongs.slideUp("fast"):albumSongs.slideDown("fast");return!1});$("#album-songs").on("click",".close",function(){$(this).parent().slideUp("fast")})})});define("app/../../../application/widgets/TopSongs/js/module.js",["jquery"],function($){var hasVids=$("a.hasvid"),parents=hasVids.parent("li");parents.addClass("hasvid");hasVids.each(function(){var url=this.href;$(this).before('<a href="'+url+'#startvideo" class="vid" onmousedown="ev(\'Hot Songs Module\', \'Video\');"></a>')});$(".switchable").not(".active").hide();return $(document).on("click",".tabs span",function(){var that=$(this),ref=that.data("ref"),url=that.attr("href"),item=that.parent(),tabs=item.siblings(),container=item.parents(".tabs-wrapper"),switchables=container.find(".switchable"),target=container.find("."+ref);if(ref){tabs.removeClass("active");item.addClass("active");switchables.hide();target.fadeIn("fast");if("#"==url)return!1}})});define("lib/lyricIntroEditor",["jquery"],function($){var lyricsIntro=$("#lyrics-intro"),introView=lyricsIntro.find(".intro-view"),introEdit=lyricsIntro.find(".intro-edit"),introDone=lyricsIntro.find(".intro-done"),introRedactor=introEdit.find(".edit-description"),introInfo=lyricsIntro.find(".edit-info"),placeholder="Add song information...",maxchar=400,minchar=30;"1"!==ml.intro_locked&&$(".intro-view.empty, .view-edit-btn",lyricsIntro).on("click",function(){require(["/js/vendor/redactor.min.js"],function(){yepnope({load:"/css/vendor/redactor.css"});introRedactor.redactor({toolbar:!1,linebreaks:!0,allowedTags:["br"],placeholder:"Add song information...",focus:!0,changeCallback:function(submissionText){submissionText.length>maxchar?introInfo.html("Please enter fewer than "+maxchar+" characters").show():introInfo.empty().hide()}})});introView.hide();introEdit.show()});introEdit.find(".edit-cancel-btn").on("click",function(){introEdit.hide();introView.show();introInfo.hide().empty();introRedactor.redactor("set","")});introEdit.find(".edit-submit-btn").on("click",function(){var submissionText=introRedactor.redactor("get");submissionText!=placeholder?submissionText.length<minchar?introInfo.html("Please enter more than "+minchar+" characters").show():submissionText.length>maxchar?introInfo.html("Please enter fewer than "+maxchar+" characters").show():$.ajax({type:"POST",dataType:"json",url:ml.introAPIUrl,data:{userId:1,intro:introRedactor.redactor("get"),lyricId:ml.lyricid}}).done(function(data){if(data.error){introInfo.html(data.error).show();introInfo.html("test").show()}else{introEdit.hide();introDone.show()}}).fail(function(data){data.responseJSON&&(data.responseJSON.error?introInfo.html(data.responseJSON.error).show():introInfo.html("Sorry, we are unable to process your Lyric Inro submission at this time.").show())}):introInfo.html("Please enter a Lyric Intro").show()});return $});define("app/lyrics",["lib/common","jquery","lib/lightbox","lib/socialbar","../../../application/widgets/Poll/js/module.js","../../../application/widgets/LyricHeaderVideo/js/module.js","lib/lyricshare","../../../application/widgets/LyricBodyHeader/js/module.js","../../../application/widgets/TopSongs/js/module.js","lib/lyricIntroEditor","lib/util","vendor/domReady!"],function(ngApp,$,lightbox,SocialBar,pollInit){function reloadDisqus($container){if(disqus_thread.length>0){var $commentBox=$container.find(".your-meanings");disqus_thread.detach().appendTo($commentBox);DISQUS.reset({reload:!0,config:function(){this.page.identifier=$commentBox.data().disqusid;this.page.url=$commentBox.data().disqusurl}});disqus_thread.show();$commentBox.show().data("commentsShown",!0)}}function resetDisqus(){if(disqus_thread.length>0){var $comments=$("#comments");disqus_thread.detach().appendTo($comments);DISQUS.reset({reload:!0,config:function(){this.page.identifier="";this.page.url=window.location}});disqus_thread.show();$comments.show()}}function showLyrCorr(){closeSongMeanings();$lyricsBottom.hide();var lyricCorrection=$("#lyricCorrection"),body=lyricCorrection.val();if(ml.lyricLocked){$(".popover.edit-box").hide();$("p.actions").hide()}lyricBody.hide();$(".terms").hide();disqus_thread.hide();$("#comments").hide();$("body").addClass("lyrics-edit");lightbox.showLightBox();""!==body||ml.lyricLocked||require(["js/vendor/redactor.min.js"],function(){var lbody=$("<div></div>");yepnope({load:"/css/vendor/redactor.css"});lyricBody.find("p.verse").each(function(idx,elem){lbody.append($(elem).html()+"<br /><br />")});lyricCorrection.val(lbody.html());lyricCorrection.redactor({linebreaks:!0,toolbar:!1,deniedTags:["blockquote","script","b","strong","i","em","pre","img"],placeholder:noLyricsMsg,focus:!0})});if(ml.lyricLocked&&!TodoListSeen){$.ajax({type:"POST",dataType:"json",url:"lyricsubmission/get_todo_list/",data:{artistid:ml.artistid,searcht:ml.searcht}}).done(function(data){if(data.error){errorDiv=$(".lyricCorrectionError");ptag=$("<p></p>").append(data.error);errorDiv.html(ptag);ev("Errors","HTML in Corrections")}else{correctTab=$("<div></div>").attr("class","thank-you").css("display","none").css("padding-top","2em");correctTab.append("<h3>Thank You For Your Interest!</h3><p>This lyric is considered accurate or cannot be edited.</p>");lyricsCorrect.html(correctTab);if(data){correctTab.append("<p>Since you're so awesome, here are some other lyrics you might also be able to help us with...</p>");utag=$("<ul></ul>");$.each(data,function(index,value){newtag=$("<a></a>").attr("href",value.anchor).attr("onmousedown","ev('Lyrics Toolbar','Lyrics Suggestion');").append(value.title+" by "+value.artist);newtag.attr("class","song");ltag=$("<li></li>").append(newtag);utag.append(ltag)});correctTab.append(utag);ptag3=$("<p></p>").attr("class","actions");closetag=$("<span>No Thanks!</span>").attr("class","action alt");closetag.on("click",function(){closeLyrCorr();return!1});ptag3.append(closetag);correctTab.append(ptag3)}$("html,body").animate({scrollTop:0});$(".thank-you").fadeIn("fast");TodoListSeen=!0}}).fail(function(){lyricsCorrect.html("There is an error with your submission.");$("html,body").animate({scrollTop:0})});return!1}}function closeLyrCorr(){lyricsCorrect.hide();$lyricsBottom.show();$("#lyrics-body").show();$(".terms").show();$("body").removeClass("lyrics-edit");lightbox.hideLightBox();resetDisqus()}function closeSongMeanings(){songMeanings.each(function(){$(this).slideUp()});$(".your-meanings:visible").hide();$(".your-meanings").each(function(){$(this).data("commentsShown",!1)});$(".your-meanings-btn").each(function(){$(".btn-text",this).text("EDIT / IMPROVE")});resetDisqus()}pollInit(ngApp);var lyricBody=($("#overlay"),$("#lightbox"),$("#lyrics-body")),songMeaningTags=$("a.songmeaning"),songMeanings=lyricBody.find(".song-meaning"),lyricVideoContainer=$(".video-container"),lyricsVideo=$("#lyrics-video-over"),lyricsCorrect=$("#lyrics-correct"),$lyricCorrectLinks=$(".correct-link"),$lyricsBottom=$(".lyrics-bottom"),shareUrl=($(".lyrics-top"),lyricsVideo.find(".embed"),$("#share-url")),disqus_thread=$("#disqus_thread"),hash=window.location.hash,noLyricsMsg="Enter the lyrics here...",TodoListSeen=!1;disqus_thread.length>0&&yepnope({load:"//metrolyrics.disqus.com/embed.js"});!function(){encodeURIComponent(navigator.userAgent)}();$(function(){lyricVideoContainer.lyricHeaderVideo();SocialBar.init()});lightbox.init({selector:"#lyrics-correct",detach:!1,onclose:function(){lyricsCorrect.hide();$("#lyrics-body").show();$(".terms").show();$("body").removeClass("lyrics-edit");$lyricsBottom.show();resetDisqus()}});$(".song-meaning span.close").on("mouseup",function(){resetDisqus()});shareUrl.on("click",function(){shareUrl.focus();shareUrl.select()});songMeaningTags.on("click",function(event){event.preventDefault();closeSongMeanings();var that=$(this),meaningId=that.attr("id").replace("a_link_",""),meaning=$("#sm"+meaningId);that.after(meaning);that.data("smmoved",!0);if(meaning.is(":visible"))meaning.slideUp();else{songMeanings.promise().done(function(){meaning.slideDown("fast",function(){meaning.attr("style","")})});om.trackSongMID({id:meaningId});ev("Song Meaning","Item")}reloadDisqus(meaning);return!1}).mouseenter(function(){var meaningId=$(this).data("smid");lyricBody.find(".sm"+meaningId).addClass("active")}).mouseleave(function(){songMeaningTags.removeClass("active")});$(".song-meaning-share-btn").click(function(){var mShare=$(this).next(".song-meaning-share");mShare.is(":visible")?mShare.hide():mShare.show();return!1});$(".your-meanings-btn").click(function(){var $base=$(this).parentsUntil(".song-meaning.popover").parent(),$content=$base.find(".edit-body");if($(this).is(".disabled")){$(this).html('<span aria-hidden="true" class="icon icon-meanings"></span>Your Meanings');disqus_thread.hide();commentBox.hide();that.data("commentsShown",!1)}else if("EDIT / IMPROVE"==$(".btn-text",this).text())require(["vendor/redactor.min.js"],function(){yepnope({load:"/css/vendor/redactor.css"});$content.redactor({toolbar:!0,buttons:["bold","italic"],linebreaks:!0,deniedTags:["blockquote","script","b","strong","i","em","pre","img","h1","h2","h3"],placeholder:"Add song meaning here...",focus:!0});$content.data("oldtext",$content.redactor("get"));ev("Song Meaning","Edit");$(".btn-text",$base).text("SUBMIT")});else{var newtext=$content.redactor("get"),smid=$base.attr("id").replace("sm","");$.ajax({type:"POST",dataType:"json",url:ml.smAPIUrl,data:{userId:1,meaning:newtext,lyricId:ml.lyricid,smid:smid}}).done(function(){$(".content-done .done-title").text("Thank You For Your Submission");$(".content-done .done-body").text("Your song meaning will appear once it has been deemed awesome by our team of wizards.")}).fail(function(data){$(".content-done .done-title").text("Sorry but something is wrong ...");$(".content-done .done-body").text(data.responseJSON.error)});ev("Song Meaning","Submit");$content.redactor("set",$content.data("oldtext"));$content.redactor("destroy");$content.removeData("oldtext");$(".content-edit",$base).hide();$(".content-done",$base).show()}return!1});$("span.corr")&&$("span.corr").on("click",function(){lyricVideoContainer.data("plugin_lyricHeaderVideo").closeLyrVid();showLyrCorr();return!1});$lyricCorrectLinks.on("click",function(){lyricVideoContainer.data("plugin_lyricHeaderVideo").closeLyrVid();lyricsCorrect.is(":visible")?closeLyrCorr():showLyrCorr();return!1});$("#cancelLyrCorr").on("click",function(){closeLyrCorr();return!1});$("#submitLyrCorr").on("click",function(){var body=$("#lyricCorrection").val(),lyricid=ml.lyricid;$.ajax({type:"POST",dataType:"json",url:"lyricsubmission/correction/"+lyricid,data:{body:body,userId:0}}).done(function(data){if(data.error){errorDiv=$(".lyricCorrectionError");ptag=$("<p></p>").append(data.error);errorDiv.html(ptag);ev("Errors","HTML in Corrections")}else{correctTab=$("<div></div>").attr("class","thank-you");correctTab.append("<h3>Thank You For Your Submission!</h3><p>The correction will go live once we verify it.</p>");lyricsCorrect.html(correctTab);if(data){correctTab.append("<p>Since you're so awesome, here are some other lyrics you might also be able to help us with...</p>");utag=$("<ul></ul>");for(item in data){newtag=$("<a></a>").attr("href",data[item].anchor).attr("onmousedown","ev('Lyrics Toolbar','Lyrics Suggestion');").append(data[item].title+" by "+data[item].artist);newtag.attr("class","song");ltag=$("<li></li>").append(newtag);utag.append(ltag)}correctTab.append(utag);ptag3=$("<p></p>").attr("class","actions");closetag=$("<span>No Thanks!</span>").attr("class","action alt");closetag.on("click",function(){closeLyrCorr();return!1});ptag3.append(closetag);correctTab.append(ptag3)}$("html,body").animate({scrollTop:0})}}).fail(function(){lyricsCorrect.html("There is an error with your submission.");$("html,body").animate({scrollTop:0})});return!1});songMeanings.find(".close").on("click",function(){$(this).parent(".song-meaning").slideUp()});$(".lyrics-body").lyricShare({imageUrl:ml.shareImage,selector:"p.verse"});$(function(){if(hash.indexOf("sm")>=0){var meaningId=hash.replace("#sm",""),songMeaningTag=$("#a_link_"+meaningId),meaning=$(hash);if(0!=meaning.size()){songMeaningTag.after(meaning);reloadDisqus(meaning);meaning.slideDown("fast",function(){meaning.attr("style","")});om.trackSongMeaningID({id:meaningId});ev("Song Meaning","Item");var position=meaning.position();position.top-=50;$("html, body").animate({scrollTop:position.top},100)}}});angular.bootstrap(document,["ngApp"])});require(["app/lyrics"]);define("lyrics",function(){});